# Meta-Protocol — Spec & Docs Update Flow

This document defines how architectural discussions and design changes are
translated into concrete updates to the files in this repository.

The goal is to allow AI tools (e.g. Cursor, Codex) to act as a **middle agent**
that:

- Receives structured change requests
- Applies them to the relevant files in `docs/` and `tasks/`
- Keeps the documentation and specs consistent and up to date

## Concepts

- **Meta Command** — a single structured instruction to modify one or more
  documentation or spec files.
- **Meta Block** — a JSON object that conforms to the schema in
  `meta-schema.json` and represents a Meta Command.
- **Middle Agent** — a tool (usually Cursor or Codex) that reads a Meta Block
  and applies the described changes.

Meta Blocks are intended to be generated by ChatGPT (or written by hand) and
then executed by a middle agent.

## Operations

Every Meta Block must specify an `op` (operation). The supported operations
are:

- `create_file` — create a new file with the given content
- `append_section` — append a new section to the end of a Markdown file
- `replace_section` — replace the content of a named Markdown section
- `delete_section` — remove a named Markdown section
- `update_schema` — update a JSON/TS schema fragment
- `rename_heading` — rename a Markdown heading

For full details see `meta-schema.json` and `meta-commands.md`.

## Example Meta Block (Markdown Section Update)

```json
{
  "op": "replace_section",
  "target": "docs/architecture/01-overview.md",
  "section": "## Processes and Responsibilities",
  "content": "## Processes and Responsibilities\\n\\n(Updated section text here...)",
  "notes": "Clarify responsibilities between Signal and Pulse."
}
```

A middle agent should:
	1.	Locate the target file.
	2.	Find the specified section heading.
	3.	Replace that heading and its section body with content.

Expectations for Middle Agents

Middle agents should:
	•	Treat meta-schema.json as the authoritative schema for Meta Blocks.
	•	Refuse to perform operations that do not validate against the schema.
	•	Avoid making edits outside the scope of the given Meta Block.
	•	Prefer deterministic changes (idempotent where possible).

For complex changes, multiple Meta Blocks can be applied in sequence.

Human Review

Even though Meta Blocks are designed for automation, all changes to this
repository should be reviewed by a human (via normal Git history and diff
tools), especially when they affect:
	•	IPC specifications in docs/specs/
	•	Real-time guidelines
	•	ADRs in docs/decisions/
